{"version":"0.3.0","body":"function main(workbook: ExcelScript.Workbook) {\n    // Planilha ativa\n    const sheet = workbook.getActiveWorksheet();\n\n    // Lista de colunas que queremos manter\n    const colunasDesejadas = [\n        \"TP_GRAU_ACADEMICO\",\n        \"TP_MODALIDADE_ENSINO\",\n        \"TP_ORGANIZACAO_ACADEMICA\",\n        \"TP_CATEGORIA_ADMINISTRATIVA\",\n        \"TP_REDE\",\n        \"IN_CAPITAL\",\n        \"CO_REGIAO\",\n        \"CO_MUNICIPIO\",\n        \"CO_UF\", \n      \"QT_ATIV_EXTRACURRICULAR\", \"QT_APOIO_SOCIAL\", \"QT_MAT\", \"QT_SIT_TRANSFERIDO\", \"QT_SIT_DESVINCULADO\", \n    ];\n\n    // Pega o intervalo usado na planilha\n    const usedRange = sheet.getUsedRange();\n    if (!usedRange) {\n        console.log(\"A planilha está vazia.\");\n        return;\n    }\n\n    // Pega a linha de cabeçalho (primeira linha do intervalo usado)\n    const headerRange = usedRange.getRow(0).getValues()[0] as string[];\n\n    // Identifica os índices das colunas desejadas\n    const indicesDesejados: number[] = [];\n    const colunasNaoEncontradas: string[] = [];\n\n    colunasDesejadas.forEach(col => {\n        const idx = headerRange.indexOf(col);\n        if (idx !== -1) {\n            indicesDesejados.push(idx);\n        } else {\n            colunasNaoEncontradas.push(col);\n        }\n    });\n\n    // Ordena os índices decrescentes para remoção segura\n    for (let i = headerRange.length - 1; i >= 0; i--) {\n        if (!indicesDesejados.includes(i)) {\n            sheet.getRangeByIndexes(0, i, usedRange.getRowCount(), 1)\n                .delete(ExcelScript.DeleteShiftDirection.left);\n        }\n    }\n\n    // Retorna no log quais colunas não foram encontradas\n    if (colunasNaoEncontradas.length > 0) {\n        console.log(\"Colunas não encontradas: \" + colunasNaoEncontradas.join(\", \"));\n    } else {\n        console.log(\"Todas as colunas desejadas foram encontradas.\");\n    }\n}\n","description":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}